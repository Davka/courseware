(function(e){function t(t){for(var s,a,r=t[0],l=t[1],c=t[2],d=0,h=[];d<r.length;d++)a=r[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&h.push(o[a][0]),o[a]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);u&&u(t);while(h.length)h.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],s=!0,r=1;r<i.length;r++){var l=i[r];0!==o[l]&&(s=!1)}s&&(n.splice(t--,1),e=a(a.s=i[0]))}return e}var s={},o={index:0},n=[];function a(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=s,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(i,s,function(t){return e[t]}.bind(null,s));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../plugins_packages/virtUOS/Courseware/views/block_manager/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=l;n.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("b635")},b635:function(e,t,i){"use strict";i.r(t);i("14c6"),i("08c1"),i("4842"),i("d9fc");var s=i("2b0e"),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"cw-blockmanager-content"}},[i("div",{staticClass:"cw-blockmanager-wrapper"},[i("div",{staticClass:"cw-blockmanager-title"},[i("p",[e._v(e._s(this.courseware.title))]),i("div",{staticClass:"cw-blockmanager-title-loading"},[e.storeLock?i("spring-spinner",{attrs:{"animation-duration":1e3,size:30,color:"#28497c"}}):e._e()],1),i("ActionMenuItem",{attrs:{buttons:["add-child"],element:this.courseware},on:{"add-child":e.addChild}})],1),i("draggable",e._b({staticClass:"chapter-list",attrs:{tag:"ul",list:e.chapters,group:{name:"chapters"},"ghost-class":"ghost",handle:".chapter-handle"},on:{sort:e.sortChapters}},"draggable",e.storeLock?{disabled:!0}:{disabled:!1,animation:200},!1),e._l(this.chapters,(function(t){return i("ChapterItem",{key:t.id,attrs:{element:t,importContent:!1,remoteContent:!1,storeLock:e.storeLock},on:{listUpdate:e.updateList,"remove-chapter":e.removeChapter,isRemote:e.isRemoteAction,isImport:e.isImportAction}})})),1)],1),i("div",{staticClass:"cw-blockmanager-wrapper",attrs:{id:"cw-action-wrapper"}},[i("div",{staticClass:"cw-blockmanager-title",attrs:{id:"cw-import-title"}},[i("p",[e._v(e._s(e.actionTitle))])]),e.fileError?i("div",{staticClass:"messagebox messagebox_error"},[e._v("\n            "+e._s(e.$t("message.invalidArchiveFile"))+"\n        ")]):e._e(),!e.showRemoteCourseware||e.remoteCourseware||e.loading?e._e():i("div",{attrs:{id:"user-course-list"}},[i("ul",{staticClass:"semester-list"},[e._l(this.remoteCourses,(function(t,s){return i("SemesterItem",{key:s,attrs:{courses:t,semester_name:s},on:{"course-selected":e.getRemoteCourse}})})),0==this.remoteCourses.length?i("div",{staticClass:"messagebox messagebox_info"},[e._v("\n                    "+e._s(e.$t("message.noRemoteCoursesAvailable"))+"\n                ")]):e._e()],2)]),e.showRemoteCourseware&&e.remoteCourseware?i("div",{staticClass:"cw-remote-courseware"},[i("draggable",e._b({staticClass:"chapter-list chapter-list-import",attrs:{tag:"ul",list:this.remoteCourseware.children,group:{name:"chapters",pull:"clone",put:!1},"ghost-class":"ghost",handle:".chapter-handle"},on:{clone:e.cloning}},"draggable",e.storeLock?{disabled:!0}:{disabled:!1,animation:200,sort:!1},!1),e._l(this.remoteCourseware.children,(function(t){return i("ChapterItem",{key:t.id,attrs:{element:t,importContent:!0,remoteContent:!0,storeLock:e.storeLock}})})),1)],1):e._e(),e.showImportCourseware&&e.importCourseware?i("div",{attrs:{id:"cw-import-lists"}},[i("draggable",e._b({staticClass:"chapter-list chapter-list-import",attrs:{tag:"ul",list:this.importCourseware.chapters,group:{name:"chapters",pull:"clone",put:!1},"ghost-class":"ghost",handle:".chapter-handle"}},"draggable",e.storeLock?{disabled:!0}:{disabled:!1,animation:200,sort:!1},!1),e._l(this.importCourseware.chapters,(function(t){return i("ChapterItem",{key:t.id,attrs:{element:t,importContent:!0,remoteContent:!1,storeLock:e.storeLock}})})),1)],1):e._e(),e.showExportCourseware?i("div"):e._e(),e.showRemoteCourseware||e.showImportCourseware||e.showExportCourseware?e._e():i("ul",{attrs:{id:"cw-action-selection"}},[i("li",[i("label",{staticClass:"cw-action-menu-button",attrs:{for:"cw-file-upload-import",id:"cw-file-upload-import-label",title:e.$t("message.importFromArchiveExplain")}},[i("input",{staticClass:"cw-file-upload-import",attrs:{type:"file",name:"cw-file-upload-import",id:"cw-file-upload-import",accept:".zip"},on:{change:e.setImport}}),i("p",[e._v(e._s(e.$t("message.importFromArchiveButton")))])])]),i("li",[i("div",{staticClass:"cw-action-menu-button",attrs:{id:"cw-import-from-course",title:e.$t("message.importFromCourseExplain")},on:{click:e.importFromCourse}},[i("p",[e._v(e._s(e.courseImportText))])])]),i("li",[i("a",{attrs:{href:e.coursewareExportURL}},[i("div",{staticClass:"cw-action-menu-button",attrs:{id:"cw-export-download",title:e.$t("message.exportExplain")}},[i("p",[e._v(e._s(e.$t("message.exportButton")))])])])])]),(e.showRemoteCourseware||e.showImportCourseware)&&e.loading?i("div",[i("spring-spinner",{staticClass:"cw-action-loading",attrs:{"animation-duration":3e3,size:65,color:"#28497c"}})],1):e._e(),i("div",{staticClass:"cw-action-button-wrapper"},[(e.showRemoteCourseware||e.showImportCourseware||e.showExportCourseware)&&!e.loading?i("button",{staticClass:"button",attrs:{id:"cw-reset-action-menu"},on:{click:e.resetActionMenu}},[e._v("\n                "+e._s(e.$t("message.tasksBackButton"))+"\n            ")]):e._e(),!e.showImportCourseware||e.fileError||e.loading?e._e():i("button",{staticClass:"button",attrs:{id:"cw-import"},on:{click:e.importCompleteArchive}},[e._v("\n                "+e._s(e.$t("message.importingButton"))+"\n            ")]),e.showExportCourseware?i("a",{attrs:{href:e.coursewareExportURL}},[i("button",{staticClass:"button",attrs:{id:"cw-export"}},[e._v("\n                    "+e._s(e.$t("message.exportingButton"))+"\n                ")])]):e._e(),i("div",{staticStyle:{clear:"both"}})])])])},n=[],a=(i("e285"),i("c880"),i("0c1f"),i("2e73"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"chapter-item",class:{"chapter-item-import":e.importContent,"chapter-item-remote":e.remoteContent},attrs:{"data-id":e.id}},[i("div",{staticClass:"chapter-description chapter-handle",class:{"full-width":e.importContent||e.remoteContent,unfolded:e.unfolded},on:{click:e.toggleContent}},[i("p",{staticClass:"chapter-title",attrs:{title:e.title}},[e._v("\n            "+e._s(e.shortTitle)+"\n        ")]),i("p",{staticClass:"header-info-wrapper"},[i("span",{class:{"unpublished-info":!e.isPublished&&(e.publication_date||e.withdraw_date),"published-info":e.isPublished&&(e.publication_date||e.withdraw_date)}},[e._v("\n                "+e._s(e.$t("message.chapter"))+"\n            ")]),!e.publication_date||this.importContent||this.remoteContent?e._e():i("span",{class:{"unpublished-info":!e.isPublished,"published-info":e.isPublished}},[e._v("| "+e._s(e.$t("message.visibleFrom"))+": "+e._s(e.publication_date_readable))]),!e.withdraw_date||this.importContent||this.remoteContent?e._e():i("span",{class:{"unpublished-info":!e.isPublished,"published-info":e.isPublished}},[e._v("\n                | "+e._s(e.$t("message.invisibleFrom"))+": "+e._s(e.withdraw_date_readable))])])]),this.importContent||this.remoteContent?e._e():i("ActionMenuItem",{class:{unfolded:e.unfolded},attrs:{buttons:["edit","remove","groups","users","add-child"],element:this.element},on:{edit:e.editElement,remove:e.removeElement,"add-child":e.addChild}}),e.unfolded?i("draggable",e._b({staticClass:"subchapter-list",class:{"subchapter-list-import":e.importContent},attrs:{tag:"ul",list:e.subchapters,group:e.draggableGroup,"ghost-class":"ghost",handle:".subchapter-handle"},on:{sort:e.sortSubchapters}},"draggable",e.dragOptions,!1),[e._l(e.subchapters,(function(t){return i("SubchapterItem",{key:t.id,attrs:{element:t,importContent:e.importContent,remoteContent:e.remoteContent,storeLock:e.storeLock},on:{listUpdate:e.updateList,"remove-subchapter":e.removeSubchapter,isRemote:e.isRemoteAction,isImport:e.isImportAction}})})),0==e.subchapters.length?i("p",[e._v("\n            "+e._s(e.$t("message.emptyChapter"))+".\n            "),e.importContent?e._e():i("span",[e._v(e._s(e.$t("message.emptyChapterInfo"))+".")])]):e._e()],2):e._e()],1)}),r=[],l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"subchapter-item",class:{"subchapter-item-import":e.importContent,"subchapter-item-remote":e.remoteContent},attrs:{"data-id":e.id}},[i("div",{staticClass:"subchapter-description subchapter-handle",class:{"full-width":e.importContent||e.remoteContent,unfolded:e.unfolded},on:{click:e.toggleContent}},[i("p",{staticClass:"subchapter-title",attrs:{title:e.title}},[e._v(e._s(e.shortTitle))]),i("p",{staticClass:"header-info-wrapper"},[i("span",{class:{"unpublished-info":!e.isPublished&&(e.publication_date||e.withdraw_date),"published-info":e.isPublished&&(e.publication_date||e.withdraw_date)}},[e._v("\n                "+e._s(e.$t("message.subchapter"))+"\n            ")]),!e.publication_date||this.importContent||this.remoteContent?e._e():i("span",{class:{"unpublished-info":!e.isPublished,"published-info":e.isPublished}},[e._v("\n                | "+e._s(e.$t("message.visibleFrom"))+": "+e._s(e.publication_date_readable))]),!e.withdraw_date||this.importContent||this.remoteContent?e._e():i("span",{class:{"unpublished-info":!e.isPublished,"published-info":e.isPublished}},[e._v("\n                | "+e._s(e.$t("message.invisibleFrom"))+": "+e._s(e.withdraw_date_readable))])])]),this.importContent||this.remoteContent?e._e():i("ActionMenuItem",{class:{unfolded:e.unfolded},attrs:{buttons:["edit","remove","groups","users","add-child"],element:this.element},on:{edit:e.editElement,remove:e.removeElement,"add-child":e.addChild}}),e.unfolded?i("draggable",e._b({staticClass:"section-list",class:{"section-list-import":e.importContent},attrs:{tag:"ul",list:e.sections,group:e.draggableGroup,"ghost-class":"ghost",handle:".section-handle"},on:{sort:e.sortSections}},"draggable",e.dragOptions,!1),[e._l(e.sections,(function(t){return i("SectionItem",{key:t.id,attrs:{element:t,importContent:e.importContent,remoteContent:e.remoteContent,storeLock:e.storeLock},on:{listUpdate:e.updateList,"remove-section":e.removeSection,isRemote:e.isRemoteAction,isImport:e.isImportAction}})})),0==e.sections.length?i("p",[e._v("\n            "+e._s(e.$t("message.emptySubchapter"))+".\n            "),e.importContent?e._e():i("span",[e._v(e._s(e.$t("message.emptySubchapterInfo"))+".")])]):e._e()],2):e._e()],1)},c=[],u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"section-item",class:{"section-item-import":e.importContent,"section-item-remote":e.remoteContent},attrs:{"data-id":e.id}},[i("div",{staticClass:"section-description section-handle",class:{"full-width":e.importContent||e.remoteContent,unfolded:e.unfolded},on:{click:e.toggleContent}},[i("p",{staticClass:"section-title",attrs:{title:e.title}},[e._v(e._s(e.shortTitle))]),i("p",{staticClass:"header-info-wrapper"},[e._v(e._s(e.$t("message.section")))])]),this.importContent||this.remoteContent?e._e():i("ActionMenuItem",{class:{unfolded:e.unfolded},attrs:{buttons:["groups","users","edit","remove"],element:this.element},on:{edit:e.editSection,remove:e.removeElement}}),e.unfolded?i("draggable",e._b({staticClass:"block-list",class:{"block-list-import":e.importContent},attrs:{tag:"ul",list:e.blocks,group:e.draggableGroup,"ghost-class":"ghost",handle:".block-handle"},on:{sort:e.sortBlocks}},"draggable",e.dragOptions,!1),[e._l(e.blocks,(function(t){return i("BlockItem",{key:t.id,attrs:{block:t,importContent:e.importContent,remoteContent:e.remoteContent},on:{"remove-block":e.removeBlock,isRemote:e.isRemoteAction}})})),0==e.blocks.length?i("p",[e._v("\n            "+e._s(e.$t("message.emptySection"))+".\n            "),e.importContent?e._e():i("span",[e._v(e._s(e.$t("message.emptySectionInfo"))+".")])]):e._e()],2):e._e()],1)},d=[],h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"block-item",class:{element_hidden:!e.block.isPublished&&!this.importContent&&!this.remoteContent,"block-item-import":e.importContent,"block-item-remote":e.remoteContent},attrs:{"data-id":e.id}},[i("div",{staticClass:"block-description block-handle",class:{element_hidden:!e.block.isPublished&&!this.importContent&&!this.remoteContent,unfolded:e.unfolded},on:{click:e.toggleContent}},[i("span",{class:["block-icon cw-block-icon-"+e.block.type]}),e._v("\n        "+e._s(e.block.readable_name)+"\n    ")]),this.importContent||this.remoteContent?e._e():i("ActionMenuItem",{attrs:{buttons:["remove"],element:this.block},on:{remove:e.removeElement}}),e.unfolded?i("ul",{staticClass:"block-preview",class:{"block-preview-import":e.importContent}},[i("li",{staticClass:"block-content-preview",domProps:{innerHTML:e._s(e.preview)}})]):e._e()],1)},m=[],p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"strucutal-element-menu-wrapper"},[i("nav",{ref:"actionMenu",staticClass:"action-menu bymousedown strucutal-element-menu"},[e._m(0),i("div",{staticClass:"action-menu-content"},[i("div",{staticClass:"action-menu-title"},[e._v("\n                "+e._s(e.$t("message.actions"))+"\n            ")]),i("ul",{staticClass:"action-menu-list"},[this.users_button?i("li",{staticClass:"action-menu-item"},[i("a",{staticClass:"set-users",attrs:{href:"#"},on:{click:function(t){e.setStudentsPermissionsDialogVisible=!0,e.$refs.actionMenu.classList.remove("active")}}},[e._v("\n                        "+e._s(e.$t("message.setStudentsPermissions"))+"\n                    ")])]):e._e(),this.groups_button?i("li",{staticClass:"action-menu-item"},[i("a",{staticClass:"set-groups",attrs:{href:"#"},on:{click:function(t){e.setGroupsPermissionsDialogVisible=!0,e.$refs.actionMenu.classList.remove("active")}}},[e._v("\n                        "+e._s(e.$t("message.setGroupsPermissions"))+"\n                    ")])]):e._e(),this.edit_button?i("li",{staticClass:"action-menu-item"},[i("a",{staticClass:"edit-element",attrs:{href:"#"},on:{click:function(t){e.editDialogVisible=!0,e.$refs.actionMenu.classList.remove("active")}}},[e._v("\n                        "+e._s(e.$t("message.editElement"))+"\n                    ")])]):e._e(),this.remove_button?i("li",{staticClass:"action-menu-item"},[i("a",{staticClass:"remove-element",attrs:{href:"#"},on:{click:function(t){e.removeDialogVisible=!0,e.$refs.actionMenu.classList.remove("active")}}},[e._v("\n                        "+e._s(e.$t("message.deleteElement"))+"\n                    ")])]):e._e(),this.add_child_button?i("li",{staticClass:"action-menu-item"},[i("a",{staticClass:"add-child-element",attrs:{href:"#"},on:{click:function(t){e.addChildDialogVisible=!0,e.$refs.actionMenu.classList.remove("active")}}},[e._v("\n                        "+e._s(e.$t("message.addSubelement"))+"\n                    ")])]):e._e()])])]),i("StudentsPermissionsDialog",{attrs:{DialogVisible:this.setStudentsPermissionsDialogVisible,element:this.element},on:{close:function(t){e.setStudentsPermissionsDialogVisible=!1},set:e.setStudentsPermissionsAction}}),i("GroupsPermissionsDialog",{attrs:{DialogVisible:this.setGroupsPermissionsDialogVisible,element:this.element},on:{close:function(t){e.setGroupsPermissionsDialogVisible=!1},set:e.setGroupsPermissionsAction}}),i("EditDialog",{attrs:{DialogVisible:this.editDialogVisible,element:this.element},on:{close:function(t){e.editDialogVisible=!1},edit:e.editDialogAction}}),i("RemoveDialog",{attrs:{DialogVisible:this.removeDialogVisible,element:this.element},on:{close:function(t){e.removeDialogVisible=!1},remove:function(t){return e.$emit("remove")}}}),i("AddChildDialog",{attrs:{DialogVisible:this.addChildDialogVisible,element:this.element},on:{close:function(t){e.addChildDialogVisible=!1},"add-child":e.addChildDialogAction}})],1)},b=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a",{staticClass:"action-menu-icon",attrs:{title:"Aktionen",href:"#"}},[i("div"),i("div"),i("div")])}],g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return this.visible?i("div",{staticClass:"cw-dialog"},[i("transition",{attrs:{name:"modal-fade"}},[i("div",{staticClass:"modal-backdrop"},[i("div",{staticClass:"modal alert",attrs:{role:"dialog"}},[i("header",{staticClass:"modal-header"},[e._t("header",[e._v("\n                        "+e._s(e.$t("message.deleteDialogTitle",[this.title]))+"\n                        "),i("span",{staticClass:"modal-close-button",on:{click:e.close}})])],2),i("section",{staticClass:"modal-body"},[this.currentElement.isStrucutalElement?i("p",[e._v("\n                        "+e._s(e.$t("message.deleteDialogQuestionElement"))+"?\n                    ")]):e._e(),this.currentElement.isBlock?i("p",[e._v(e._s(e.$t("message.deleteDialogQuestionBlock"))+"?")]):e._e()]),i("footer",{staticClass:"modal-footer"},[e._t("footer",[e.deleting?i("button",{staticClass:"button modal-progress",attrs:{type:"button"}},[i("spring-spinner",{staticClass:"modal-progress-spinner",attrs:{"animation-duration":3e3,size:14,color:"#28497c"}})],1):i("button",{staticClass:"button accept",attrs:{type:"button"},on:{click:e.remove}},[e._v("\n                            "+e._s(e.$t("message.ButtonLabelYes"))+"\n                        ")]),i("button",{staticClass:"button cancel",class:{"button-inactive":e.deleting},attrs:{type:"button"},on:{click:e.close}},[e._v("\n                            "+e._s(e.$t("message.ButtonLabelNo"))+"\n                        ")])])],2)])])])],1):e._e()},f=[],_=i("4583"),v={name:"RemoveDialog",components:{SpringSpinner:_["a"]},props:{DialogVisible:Boolean,element:Object},data:function(){return{visible:this.DialogVisible,title:"",currentElement:this.element,deleting:!1}},mounted:function(){this.currentElement&&(this.currentElement.isBlock&&(this.title=this.currentElement.readable_name),this.currentElement.isStrucutalElement&&(this.title=this.currentElement.title))},methods:{close:function(){this.deleting||this.$emit("close")},remove:function(){var e={},t=this;e.id=this.currentElement.id,this.deleting=!0,$.ajax({type:"DELETE",url:"../blocks/"+e.id,contentType:"application/json",data:e,success:function(){t.$emit("remove"),t.deleting=!1,t.$emit("close")},error:function(){console.log("can not remove node!"),t.deleting=!1,t.$emit("close")}})}},watch:{DialogVisible:function(){this.visible=this.DialogVisible}}},C=v,w=i("2877"),k=Object(w["a"])(C,g,f,!1,null,null,null),D=k.exports,y=function(){var e=this,t=e.$createElement,i=e._self._c||t;return this.visible?i("div",{staticClass:"cw-dialog"},[i("transition",{attrs:{name:"modal-fade"}},[i("div",{staticClass:"modal-backdrop"},[i("div",{staticClass:"modal",attrs:{role:"dialog"}},[i("header",{staticClass:"modal-header"},[e._t("header",[e._v("\n                        "+e._s(e.$t("message.editDialogTitle",[this.title]))+"\n                        "),i("span",{staticClass:"modal-close-button",on:{click:e.close}})])],2),i("section",{staticClass:"modal-body"},[i("label",{attrs:{for:"editDialogElementTitle"}},[e._v(e._s(e.$t("message.title"))+":")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],attrs:{type:"text",name:"editDialogElementTitle"},domProps:{value:e.title},on:{input:function(t){t.target.composing||(e.title=t.target.value)}}}),i("br"),e.isChapter?i("div",[i("label",{attrs:{for:"publication_date"}},[e._v(e._s(e.$t("message.visibleFrom"))+":")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.publicationDate,expression:"publicationDate"}],attrs:{type:"date",name:"publication_date",max:e.maxPublicationDate},domProps:{value:e.publicationDate},on:{input:function(t){t.target.composing||(e.publicationDate=t.target.value)}}}),i("br"),i("label",{attrs:{for:"withdraw_date"}},[e._v(e._s(e.$t("message.invisibleFrom"))+":")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.withdrawDate,expression:"withdrawDate"}],attrs:{type:"date",name:"withdraw_date",min:e.minWithdrawDate},domProps:{value:e.withdrawDate},on:{input:function(t){t.target.composing||(e.withdrawDate=t.target.value)}}})]):e._e()]),i("footer",{staticClass:"modal-footer"},[e._t("footer",[i("button",{staticClass:"button accept",attrs:{type:"button"},on:{click:e.edit}},[e._v("\n                            "+e._s(e.$t("message.ButtonLabelSave"))+"\n                        ")]),i("button",{staticClass:"button cancel",attrs:{type:"button"},on:{click:e.close}},[e._v("\n                            "+e._s(e.$t("message.ButtonLabelClose"))+"\n                        ")])])],2)])])])],1):e._e()},E=[],A=(i("ae66"),{name:"EditDialog",props:{DialogVisible:Boolean,element:Object},data:function(){return{visible:this.DialogVisible,title:"",currentElement:this.element,isChapter:!1,publicationDate:null,maxPublicationDate:"",withdrawDate:null,minWithdrawDate:""}},mounted:function(){this.currentElement&&(this.title=this.currentElement.title,"Chapter"!=this.currentElement.type&&"Subchapter"!=this.currentElement.type||(this.isChapter=!0,this.currentElement.publication_date&&(this.publicationDate=this.convertTimestampToDate(this.currentElement.publication_date)),this.currentElement.withdraw_date&&(this.withdrawDate=this.convertTimestampToDate(this.currentElement.withdraw_date))))},methods:{close:function(){this.$emit("close")},edit:function(){var e=this,t={};if(t.id=this.element.id,t.title=this.title,this.isChapter){var i=/(\d{4})-(\d{2})-(\d{2})/;if(this.publicationDate&&(t.publication_date=new Date(this.publicationDate.replace(i,"$2,$3,$1")).getTime()/1e3,t.publication_date_readable=this.publicationDate.replace(i,"$3.$2.$1")),this.withdrawDate&&(t.withdraw_date=new Date(this.withdrawDate.replace(i,"$2,$3,$1")).getTime()/1e3,t.withdraw_date_readable=this.withdrawDate.replace(i,"$3.$2.$1")),t.withdraw_date<=t.publication_date)return;t.isPublished=this.isPublished(this.publicationDate,this.withdrawDate)}$.ajax({type:"PUT",url:"../blocks/"+t.id,contentType:"application/json",data:JSON.stringify(t),success:function(){e.$emit("edit",t),e.$emit("close")},error:function(){console.log("can not remove node!"),e.$emit("close")}})},convertTimestampToDate:function(e){var t=new Date(e);return t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)},isPublished:function(e,t){var i=new Date;return(new Date(e)<i||null==e)&&(new Date(t)>i||null==t)}},watch:{DialogVisible:function(){this.visible=this.DialogVisible},publicationDate:function(){this.minWithdrawDate=this.convertTimestampToDate(this.publicationDate)},withdrawDate:function(){this.maxPublicationDate=this.convertTimestampToDate(this.withdrawDate)}}}),S=A,L=Object(w["a"])(S,y,E,!1,null,null,null),x=L.exports,B=function(){var e=this,t=e.$createElement,i=e._self._c||t;return this.visible?i("div",{staticClass:"cw-dialog"},[i("transition",{attrs:{name:"modal-fade"}},[i("div",{staticClass:"modal-backdrop"},[i("div",{staticClass:"modal",attrs:{role:"dialog"}},[i("header",{staticClass:"modal-header"},[e._t("header",[e._v("\n                        "+e._s(e.$t("message.addDialogTitle"))+"\n                        "),i("span",{staticClass:"modal-close-button",on:{click:e.close}})])],2),i("section",{staticClass:"modal-body"},[i("label",{attrs:{for:"editDialogElementTitle"}},[e._v(e._s(e.$t("message.title"))+":")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],ref:"editDialogElementTitle",attrs:{type:"text",name:"editDialogElementTitle"},domProps:{value:e.title},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.edit(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.close(t)}],input:function(t){t.target.composing||(e.title=t.target.value)}}})]),i("footer",{staticClass:"modal-footer"},[e._t("footer",[i("button",{staticClass:"button accept",attrs:{type:"button"},on:{click:e.edit}},[e._v("\n                            "+e._s(e.$t("message.ButtonLabelSave"))+"\n                        ")]),i("button",{staticClass:"button cancel",attrs:{type:"button"},on:{click:e.close}},[e._v("\n                            "+e._s(e.$t("message.ButtonLabelClose"))+"\n                        ")])])],2)])])])],1):e._e()},I=[],P=i("bc3a"),O=i.n(P),T={name:"AddChildDialog",props:{DialogVisible:Boolean,element:Object},data:function(){return{visible:this.DialogVisible,type:this.element.childType,title:"",currentElement:this.element}},mounted:function(){},methods:{close:function(){this.$emit("close"),this.title=""},edit:function(){var e=this;""==this.title&&(this.title="new "+this.type),O.a.post("add_structure",{parent:e.element.id,title:e.title,type:e.type,cid:COURSEWARE.config.cid}).then((function(t){e.$emit("add-child",t.data),e.close()})).catch((function(t){console.log("there was an error: "+t.response),e.close()}))}},watch:{DialogVisible:function(){var e=this;this.visible=this.DialogVisible,this.$nextTick((function(){e.$refs.editDialogElementTitle&&e.$refs.editDialogElementTitle.focus()}))}}},R=T,U=Object(w["a"])(R,B,I,!1,null,null,null),V=U.exports,G=function(){var e=this,t=e.$createElement,i=e._self._c||t;return this.visible?i("div",{staticClass:"cw-dialog"},[i("transition",{attrs:{name:"modal-fade"}},[i("div",{staticClass:"modal-backdrop"},[i("div",{staticClass:"modal",attrs:{role:"dialog"}},[i("header",{staticClass:"modal-header"},[e._t("header",[e._v("\n                        "+e._s(e.$t("message.setStudentsPermissions"))+"\n                        "),i("span",{staticClass:"modal-close-button",on:{click:e.close}})])],2),i("section",{staticClass:"modal-body"},[i("ul",{staticClass:"students-permissions-list"},e._l(e.users,(function(t){return i("li",{key:t.id},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.checkedUsers,expression:"checkedUsers"}],attrs:{type:"checkbox"},domProps:{value:t.user_id,checked:Array.isArray(e.checkedUsers)?e._i(e.checkedUsers,t.user_id)>-1:e.checkedUsers},on:{change:function(i){var s=e.checkedUsers,o=i.target,n=!!o.checked;if(Array.isArray(s)){var a=t.user_id,r=e._i(s,a);o.checked?r<0&&(e.checkedUsers=s.concat([a])):r>-1&&(e.checkedUsers=s.slice(0,r).concat(s.slice(r+1)))}else e.checkedUsers=n}}}),e._v("\n                                "+e._s(t.firstname)+"\n                                "+e._s(t.lastname)+"\n                                "),i("i",[e._v(e._s(t.username))])])])})),0)]),i("footer",{staticClass:"modal-footer"},[e._t("footer",[i("button",{staticClass:"button accept",attrs:{type:"button"},on:{click:e.set}},[e._v("\n                            "+e._s(e.$t("message.ButtonLabelSave"))+"\n                        ")]),i("button",{staticClass:"button cancel",attrs:{type:"button"},on:{click:e.close}},[e._v("\n                            "+e._s(e.$t("message.ButtonLabelClose"))+"\n                        ")])])],2)])])])],1):e._e()},F=[],M={name:"StudentsPermissionsDialog",props:{DialogVisible:Boolean,element:Object},data:function(){return{visible:this.DialogVisible,currentElement:this.element,users:this.$store.state.courseUsers,checkedUsers:[]}},methods:{close:function(){this.deleting||this.$emit("close")},set:function(){var e=this,t=this.element.id,i={};i.users=this.checkedUsers,O.a.post("set_element_approval_list",{bid:t,list:JSON.stringify(i)}).then((function(t){console.log(t),e.$emit("close")})).catch((function(t){console.log(t),e.$emit("close")}))},getApprovalList:function(){var e=this.element.id,t=this;O.a.post("get_element_approval_list",{bid:e,type:"users"}).then((function(e){null!=e.data&&(t.checkedUsers=e.data)})).catch((function(e){console.log(e)}))}},watch:{DialogVisible:function(){this.visible=this.DialogVisible,this.users=this.$store.state.courseUsers,this.visible?this.getApprovalList():this.checkedUsers=[]}}},j=M,N=Object(w["a"])(j,G,F,!1,null,null,null),z=N.exports,J=function(){var e=this,t=e.$createElement,i=e._self._c||t;return this.visible?i("div",{staticClass:"cw-dialog"},[i("transition",{attrs:{name:"modal-fade"}},[i("div",{staticClass:"modal-backdrop"},[i("div",{staticClass:"modal",attrs:{role:"dialog"}},[i("header",{ref:"modalHeader",staticClass:"modal-header"},[e._t("header",[e._v("\n                        "+e._s(e.$t("message.setGroupsPermissions"))+"\n                        "),i("span",{staticClass:"modal-close-button",on:{click:e.close}})])],2),i("section",{staticClass:"modal-body"},[i("ul",{staticClass:"groups-permissions-list"},e._l(e.groups,(function(t){return i("li",{key:t.id},[i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.checkedGroups,expression:"checkedGroups"}],attrs:{type:"checkbox"},domProps:{value:t.id,checked:Array.isArray(e.checkedGroups)?e._i(e.checkedGroups,t.id)>-1:e.checkedGroups},on:{change:function(i){var s=e.checkedGroups,o=i.target,n=!!o.checked;if(Array.isArray(s)){var a=t.id,r=e._i(s,a);o.checked?r<0&&(e.checkedGroups=s.concat([a])):r>-1&&(e.checkedGroups=s.slice(0,r).concat(s.slice(r+1)))}else e.checkedGroups=n}}}),e._v(" "+e._s(t.name)+"\n                            ")])])})),0)]),i("footer",{staticClass:"modal-footer"},[e._t("footer",[i("button",{staticClass:"button accept",attrs:{type:"button"},on:{click:e.set}},[e._v("\n                            "+e._s(e.$t("message.ButtonLabelSave"))+"\n                        ")]),i("button",{staticClass:"button cancel",attrs:{type:"button"},on:{click:e.close}},[e._v("\n                            "+e._s(e.$t("message.ButtonLabelClose"))+"\n                        ")])])],2)])])])],1):e._e()},W=[],Y={name:"GroupsPermissionsDialog",props:{DialogVisible:Boolean,element:Object},data:function(){return{visible:this.DialogVisible,currentElement:this.element,groups:this.$store.state.courseGroups,checkedGroups:[]}},methods:{close:function(){this.deleting||this.$emit("close")},set:function(){var e=this,t=this.element.id,i={};i.groups=this.checkedGroups,O.a.post("set_element_approval_list",{bid:t,list:JSON.stringify(i)}).then((function(t){console.log(t),e.$emit("close")})).catch((function(t){console.log(t),e.$emit("close")}))},getApprovalList:function(){var e=this.element.id,t=this;O.a.post("get_element_approval_list",{bid:e,type:"groups"}).then((function(e){null!=e.data&&(t.checkedGroups=e.data)})).catch((function(e){console.log(e)}))}},watch:{DialogVisible:function(){this.visible=this.DialogVisible,this.groups=this.$store.state.courseGroups,this.visible?this.getApprovalList():this.checkedGroups=[]}}},Z=Y,Q=Object(w["a"])(Z,J,W,!1,null,null,null),X=Q.exports,K={props:{buttons:Array,element:Object},components:{RemoveDialog:D,EditDialog:x,AddChildDialog:V,StudentsPermissionsDialog:z,GroupsPermissionsDialog:X},data:function(){return{edit_button:!1,remove_button:!1,groups_button:!1,users_button:!1,add_child_button:!1,removeDialogVisible:!1,editDialogVisible:!1,addChildDialogVisible:!1,setStudentsPermissionsDialogVisible:!1,setGroupsPermissionsDialogVisible:!1}},created:function(){var e=this;this.buttons.forEach((function(t){switch(t){case"edit":e.edit_button=!0;break;case"remove":e.remove_button=!0;break;case"add-child":e.add_child_button=!0;break;case"groups":e.groups_button=!0;break;case"users":e.users_button=!0;break}}))},methods:{editDialogAction:function(e){this.$emit("edit",e)},addChildDialogAction:function(e){this.$emit("add-child",e)},setStudentsPermissionsAction:function(e){this.$emit("set-students-permissions",e)},setGroupsPermissionsAction:function(e){this.$emit("set-groups-permissions",e)}}},H=K,q=Object(w["a"])(H,p,b,!1,null,null,null),ee=q.exports,te={name:"BlockItem",data:function(){return{id:this.block.id,preview:"",unfolded:!1}},components:{ActionMenuItem:ee},props:{block:Object,importContent:Boolean,remoteContent:Boolean},created:function(){this.preview=this.block.preview},watch:{block:function(){this.id=this.block.id}},methods:{removeElement:function(){this.$emit("remove-block",this.block)},toggleContent:function(){this.unfolded=!this.unfolded}}},ie=te,se=Object(w["a"])(ie,h,m,!1,null,null,null),oe=se.exports,ne={methods:{cutTitle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return e.length>t?e.substr(0,t-1)+"…":e},getReadableDate:function(e){var t=new Date(e);return("0"+t.getDate()).slice(-2)+"."+("0"+(t.getMonth()+1)).slice(-2)+"."+t.getFullYear()},getContent:function(e){var t={};switch(e.getAttribute("type")){case"AssortBlock":return"";case"AudioBlock":return e.getAttribute("audio:audio_file_name");case"AudioGalleryBlock":return"";case"BeforeAfterBlock":return t=JSON.parse(e.getAttribute("beforeafter:ba_before")),"url"==t.source?t.url:t.file_name;case"BlubberBlock":return"";case"CanvasBlock":return t=JSON.parse(e.getAttribute("canvas:canvas_content")),"web"==t.source?t.image_url:"cw"==t.source?t.image_name:"";case"ChartBlock":return e.getAttribute("chart:chart_type");case"CodeBlock":return e.getAttribute("code:code_content");case"ConfirmBlock":return e.getAttribute("title");case"DateBlock":return t=JSON.parse(e.getAttribute("date:date_content")),t.date+" "+t.time;case"DialogCardsBlock":return t=JSON.parse(e.getAttribute("dialogcards:dialogcards_content")),t[0].front_img_file_name;case"DiscussionBlock":return"";case"EmbedBlock":return e.getAttribute("embed:embed_source")+" "+e.getAttribute("embed:embed_url");case"FolderBlock":return"";case"ForumBlock":return"";case"GalleryBlock":return e.getAttribute("gallery:gallery_folder_name");case"HtmlBlock":return e.textContent;case"IFrameBlock":return e.getAttribute("iframe:url");case"ImageMapBlock":return JSON.parse(e.getAttribute("imagemap:image_map_content")).image_name;case"InteractiveVideoBlock":return JSON.parse(e.getAttribute("interactivevideo:iav_source")).file_name;case"KeyPointBlock":return e.getAttribute("keypoint:keypoint_content");case"LinkBlock":return e.getAttribute("link:link_target");case"OpenCastBlock":return"";case"PdfBlock":return e.getAttribute("pdf:pdf_filename");case"PostBlock":return"";case"SearchBlock":return"";case"TestBlock":var i=e.getAttribute("test:xml"),s=new DOMParser,o=s.parseFromString(i,"text/xml");return o.firstElementChild.children[0].textContent;case"TypewriterBlock":return t=JSON.parse(e.getAttribute("typewriter:typewriter_json")),t.content;case"VideoBlock":return""!=e.getAttribute("video:webvideo")?(t=JSON.parse(e.getAttribute("video:webvideo"))[0],"url"==t.source?t.src:t.file_name):e.getAttribute("video:url");default:return""}}}},ae=i("310e"),re=i.n(ae),le={name:"SectionItem",mixins:[ne],data:function(){return{id:this.element.id,title:this.element.title,shortTitle:this.element.shortTitle,unfolded:!1,blocks:this.element.children,blockList:{},draggableGroup:{name:"blocks"}}},components:{BlockItem:oe,ActionMenuItem:ee,draggable:re.a},props:{element:Object,importContent:Boolean,remoteContent:Boolean,storeLock:Boolean},created:function(){null==this.blocks&&(this.blocks=[]),this.importContent&&(this.draggableGroup={name:"blocks",pull:"clone",put:!1}),this.shortTitle=this.cutTitle(this.element.title,30)},watch:{element:function(){null==this.element.children?this.blocks=[]:this.blocks=this.element.children}},methods:{sortBlocks:function(){var e=this,t={},i=[],s=[];this.blocks.forEach((function(t){t.isRemote?(s.push("remote_"+t.id),e.$emit("isRemote")):t.isImport?(s.push("import_"+t.id),e.$emit("isImport")):s.push(t.id)})),i[this.id]=s,t.list=i,t.type="block",this.$emit("listUpdate",t)},removeBlock:function(e){var t=[];this.blocks.forEach((function(i){i.id!=e.id&&t.push(i)})),this.blocks=t},removeElement:function(){this.$emit("remove-section",this.element)},editSection:function(e){this.title=e.title,this.shortTitle=this.cutTitle(e.title,30)},toggleContent:function(){this.unfolded=!this.unfolded}},computed:{dragOptions:function(){return this.importContent?{animation:200,disabled:this.storeLock,sort:!1,ghostClass:"ghost"}:{animation:200,disabled:this.storeLock,ghostClass:"ghost"}}}},ce=le,ue=Object(w["a"])(ce,u,d,!1,null,null,null),de=ue.exports,he={name:"SubchapterItem",mixins:[ne],data:function(){return{id:this.element.id,publication_date:this.element.publication_date,publication_date_readable:this.getReadableDate(this.element.publication_date),withdraw_date:this.element.withdraw_date,withdraw_date_readable:this.getReadableDate(this.element.withdraw_date),isPublished:this.element.isPublished,title:this.element.title,shortTitle:this.element.shortTitle,unfolded:!1,sections:this.element.children,sectionList:{},draggableGroup:{name:"sections"}}},components:{SectionItem:de,ActionMenuItem:ee,draggable:re.a},props:{element:Object,importContent:Boolean,remoteContent:Boolean,storeLock:Boolean},created:function(){null==this.sections&&(this.sections=[]),this.importContent&&(this.draggableGroup={name:"sections",pull:"clone",put:!1}),this.shortTitle=this.cutTitle(this.element.title,30)},watch:{element:function(){null==this.element.children?this.sections=[]:this.sections=this.element.children}},methods:{sortSections:function(){var e=this,t={},i=[],s=[],o=!1;this.sections.forEach((function(t){t.isRemote?(s.push("remote_"+t.id),e.isRemoteAction(),null!=t.children&&(o=!0,e.buildChildrenList(t,"remote_"))):t.isImport?(s.push("import_"+t.id),e.isImportAction(),null!=t.children.length&&(o=!0,e.buildChildrenList(t,"import_"))):s.push(t.id)})),i[this.id]=s,t.list=i,t.hasChildren=o,t.type="section",this.$emit("listUpdate",t)},buildChildrenList:function(e,t){var i=this,s=[],o=[],n={},a=!1;e.children.forEach((function(e){s.push(t+e.id),null!=e.children&&(a=!0,i.buildChildrenList(e,t))})),o[t+e.id]=s,n.list=o,n.hasChildren=a,"section"==e.type.toLowerCase()?(n.type="block",this.$emit("listUpdate",n)):(n.type=e.children[0].type.toLowerCase(),this.$emit("listUpdate",n))},updateList:function(e){this.$emit("listUpdate",e)},isRemoteAction:function(){this.$emit("isRemote")},isImportAction:function(){this.$emit("isImport")},removeElement:function(){this.$emit("remove-subchapter",this.element)},editElement:function(e){this.title=e.title,this.shortTitle=this.cutTitle(e.title),this.publication_date=1e3*e.publication_date,this.publication_date_readable=e.publication_date_readable,this.withdraw_date=1e3*e.withdraw_date,this.withdraw_date_readable=e.withdraw_date_readable,this.isPublished=e.isPublished},addChild:function(e){this.sections.push(e)},removeSection:function(e){var t=[];this.sections.forEach((function(i){i.id!=e.id&&t.push(i)})),this.sections=t},toggleContent:function(){this.unfolded=!this.unfolded}},computed:{dragOptions:function(){return this.importContent?{animation:200,disabled:this.storeLock,sort:!1,ghostClass:"ghost"}:{animation:200,disabled:this.storeLock,ghostClass:"ghost"}}}},me=he,pe=Object(w["a"])(me,l,c,!1,null,null,null),be=pe.exports,ge={name:"ChapterItem",mixins:[ne],props:{element:Object,importContent:Boolean,remoteContent:Boolean,storeLock:Boolean},data:function(){return{id:this.element.id,publication_date:this.element.publication_date,publication_date_readable:this.getReadableDate(this.element.publication_date),withdraw_date:this.element.withdraw_date,withdraw_date_readable:this.getReadableDate(this.element.withdraw_date),isPublished:this.element.isPublished,title:this.element.title,shortTitle:this.cutTitle(this.element.title,30),unfolded:!1,subchapters:this.element.children,subchapterList:[],draggableGroup:{name:"subchapters"}}},components:{SubchapterItem:be,ActionMenuItem:ee,draggable:re.a},created:function(){null==this.subchapters&&(this.subchapters=[]),this.importContent&&(this.draggableGroup={name:"subchapters",pull:"clone",put:!1})},watch:{element:function(){null==this.element.children?this.subchapters=[]:this.subchapters=this.element.children}},methods:{sortSubchapters:function(){var e=this,t={},i=[],s=[],o=!1;this.subchapters.forEach((function(t){t.isRemote?(s.push("remote_"+t.id),e.isRemoteAction(),null!=t.children&&(o=!0,e.buildChildrenList(t,"remote_"))):t.isImport?(s.push("import_"+t.id),e.isImportAction(),null!=t.children&&(o=!0,e.buildChildrenList(t,"import_"))):s.push(t.id)})),i[this.id]=s,t.list=i,t.hasChildren=o,t.type="subchapter",this.$emit("listUpdate",t)},buildChildrenList:function(e,t){var i=this,s=[],o=[],n={},a=!1;e.children.forEach((function(e){s.push(t+e.id),null!=e.children&&(a=!0,i.buildChildrenList(e,t))})),o[t+e.id]=s,n.list=o,n.hasChildren=a,"section"==e.type.toLowerCase()?(n.type="block",this.$emit("listUpdate",n)):(n.type=e.children[0].type.toLowerCase(),this.$emit("listUpdate",n))},isRemoteAction:function(){this.$emit("isRemote")},isImportAction:function(){this.$emit("isImport")},updateList:function(e){this.$emit("listUpdate",e)},removeElement:function(){this.$emit("remove-chapter",this.element)},editElement:function(e){this.title=e.title,this.shortTitle=this.cutTitle(e.title),this.publication_date=1e3*e.publication_date,this.publication_date_readable=e.publication_date_readable,this.withdraw_date=1e3*e.withdraw_date,this.withdraw_date_readable=e.withdraw_date_readable,this.isPublished=e.isPublished},addChild:function(e){this.subchapters.push(e)},removeSubchapter:function(e){var t=[];this.subchapters.forEach((function(i){i.id!=e.id&&t.push(i)})),this.subchapters=t},toggleContent:function(){this.unfolded=!this.unfolded}},computed:{dragOptions:function(){return this.importContent?{animation:200,disabled:this.storeLock,sort:!1,ghostClass:"ghost"}:{animation:200,disabled:this.storeLock,ghostClass:"ghost"}}}},fe=ge,_e=Object(w["a"])(fe,a,r,!1,null,null,null),ve=_e.exports,Ce=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"semester-item"},[i("p",{staticClass:"semester-description",class:{unfolded:e.unfolded},on:{click:e.toggleList}},[e._v("\n        "+e._s(e.semester_name)+"\n    ")]),e.unfolded?i("ul",{staticClass:"course-list"},e._l(e.courses,(function(t){return i("CourseItem",{key:t.id,attrs:{course:t},on:{"course-selected":e.courseSelected}})})),1):e._e()])},we=[],ke=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("li",{staticClass:"course-item"},[i("button",{staticClass:"blockmanager-course-item",attrs:{"data-remote_cid":e.course.id,"data-remote_name":e.course.name},on:{click:function(t){return e.$emit("course-selected",{remoteName:e.course.name,remoteId:e.course.id})}}},[e._v("\n        "+e._s(e.course.name)+"\n    ")])])},De=[],ye={name:"CourseItem",data:function(){return{}},components:{},props:{course:Object},methods:{}},Ee=ye,$e=Object(w["a"])(Ee,ke,De,!1,null,"991941d8",null),Ae=$e.exports,Se={name:"SemesterItem",components:{CourseItem:Ae},props:{courses:Array,semester_name:String},data:function(){return{unfolded:!1}},methods:{courseSelected:function(e){this.$emit("course-selected",e)},toggleList:function(){this.unfolded=!this.unfolded}}},Le=Se,xe=Object(w["a"])(Le,Ce,we,!1,null,"62099320",null),Be=xe.exports,Ie={name:"BlockManager",mixins:[ne],components:{ChapterItem:ve,SemesterItem:Be,draggable:re.a,ActionMenuItem:ee,SpringSpinner:_["a"]},data:function(){return{courseware:{},remoteCourses:{},remoteCourseware:null,importCourseware:null,showRemoteCourseware:!1,showImportCourseware:!1,showExportCourseware:!1,chapters:{},chapterList:[],subchapterList:{},sectionList:{},blockList:{},actionTitle:this.$i18n.t("message.actions"),courseImportText:this.$i18n.t("message.importFromCourse"),remoteData:!1,importData:!1,importXML:"",importZIP:"",blockMap:null,fileError:!1,loading:!1,storeLock:!1,coursewareExportURL:COURSEWARE.data.courseware_export_url}},created:function(){this.courseware=JSON.parse(COURSEWARE.data.courseware),this.remoteCourses=JSON.parse(COURSEWARE.data.remote_courses),this.blockMap=JSON.parse(COURSEWARE.data.block_map)},mounted:function(){this.getCourseUsers(),this.getCourseGroups()},watch:{courseware:function(){this.chapters=this.courseware.children}},methods:{getCourseUsers:function(){var e=this;O.a.get("get_course_users",{params:{cid:COURSEWARE.config.cid}}).then((function(t){e.$store.state.courseUsers=t.data})).catch((function(e){return console.log(e),[]}))},getCourseGroups:function(){var e=this;O.a.get("get_course_groups",{params:{cid:COURSEWARE.config.cid}}).then((function(t){e.$store.state.courseGroups=t.data})).catch((function(e){return console.log(e),[]}))},sortChapters:function(){var e=this,t=!1;this.cleanLists(),this.chapters.forEach((function(i){i.isRemote?(e.chapterList.push("remote_"+i.id),e.isRemoteAction(),null!=i.children&&(t=!0,e.buildChildrenList(i,"remote_"))):i.isImport?(e.chapterList.push("import_"+i.id),e.isImportAction(),null!=i.children&&(t=!0,e.buildChildrenList(i,"import_"))):e.chapterList.push(parseInt(i.id,10))})),t||this.storeChanges()},fillChapterList:function(){var e=this;this.chapters.forEach((function(t){e.chapterList.push(t.id)}))},buildChildrenList:function(e,t){var i=this,s=[],o=!1;e.children.forEach((function(e){s.push(t+e.id),null!=e.children&&(o=!0,i.buildChildrenList(e,t))})),"section"==e.type.toLowerCase()?this.blockList[t+e.id]=s:this[e.children[0].type.toLowerCase()+"List"][t+e.id]=s,o||this.storeChanges()},isRemoteAction:function(){this.remoteData=!0,this.importData=!0},isImportAction:function(){this.remoteData=!1,this.importData=!0},updateList:function(e){var t=e.list,i=Object.keys(t)[0];this[e.type+"List"][i]=t[i],e.hasChildren||(this.fillChapterList(),this.storeChanges())},addChild:function(e){this.chapters.push(e)},removeChapter:function(e){var t=[];this.chapters.forEach((function(i){i.id!=e.id&&t.push(i)})),this.chapters=t},importFromCourse:function(){this.actionTitle=this.courseImportText,this.showRemoteCourseware=!0},showExport:function(){this.actionTitle=this.$i18n.t("message.exportButton"),this.showExportCourseware=!0},resetActionMenu:function(){this.actionTitle=this.$i18n.t("message.actions"),this.fileError=!1,this.remoteCourseware=null,this.importCourseware=null,this.exportCourseware=null,this.showRemoteCourseware=!1,this.showImportCourseware=!1,this.showExportCourseware=!1},storeChanges:function(){if(this.storeLock)console.log("storeLock");else{this.storeLock=!0;var e=this,t=[],i={};if(e.importData&&!e.remoteData){var s=this.importZIP,o=new Promise((function(e){var t=new FileReader;t.readAsDataURL(s),t.onloadend=function(){i.file=t.result,i.name=s.name,i.size=s.size,i.type=s.type,e(t.result)}}));t.push(o)}Promise.all(t).then((function(){O.a.post("store_changes_vue",{cid:COURSEWARE.config.cid,import:e.importData,remote:e.remoteData,importXML:e.importXML,chapterList:JSON.stringify(e.chapterList),subchapterList:JSON.stringify(e.subchapterList),sectionList:JSON.stringify(e.sectionList),blockList:JSON.stringify(e.blockList),fileData:i}).then((function(t){e.importData=!1,e.remoteData=!1,e.cleanLists(),e.courseware=JSON.parse(t.data.courseware),e.storeLock=!1})).catch((function(e){e.response?(console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):console.log("Error",e.message),console.log(e.config)}))}))}},cleanLists:function(){this.chapterList=[],this.subchapterList={},this.sectionList={},this.blockList={}},getRemoteCourse:function(e){this.loading=!0;var t=this;O.a.get("get_remote_course",{params:{cid:COURSEWARE.config.cid,remote_cid:e.remoteId}}).then((function(e){t.remoteCourseware=e.data})).then((function(){t.actionTitle="Import: "+e.remoteName,t.showRemoteCourseware=!0,t.loading=!1})).catch((function(e){console.log("there was an error: "+e.response)}))},setImport:function(){this.loading=!0;var e=this;e.fileError=!1,this.importZIP=event.target.files[0],this.showImportCourseware=!0,ZipLoader.unzip(this.importZIP).then((function(t){var i,s,o;if(void 0!=t.files["data.xml"]){i=t.extractAsText("data.xml"),s=new DOMParser,o=s.parseFromString(i,"text/xml");var n=0,a=0,r=0;e.importCourseware=[],e.importCourseware["chapters"]=[],$.each(o.documentElement.children,(function(t,i){if("chapter"==i.nodeName){n++,i.setAttribute("temp-id",n);var s=e.importCourseware["chapters"].push({title:i.getAttribute("title"),id:n,publication_date:!1,withdraw_date:!1,isPublished:!0,isImport:!0,type:i.nodeName}),o=e.importCourseware["chapters"][s-1];if("undefined"===typeof o)return!0;o.children=[],$.each(i.children,(function(t,i){if("subchapter"==i.nodeName){a++,i.setAttribute("temp-id",a);var s=o.children.push({title:i.getAttribute("title"),id:a,publication_date:!1,withdraw_date:!1,isPublished:!0,isImport:!0,type:i.nodeName}),n=o.children[s-1];if("undefined"===typeof n)return!0;n.children=[],$.each(i.children,(function(t,i){if("section"==i.nodeName){r++,i.setAttribute("temp-id",r);var s=n.children.push({title:i.getAttribute("title"),id:r,isPublished:!0,isImport:!0,type:i.nodeName}),o=n.children[s-1];if("undefined"===typeof o)return!0;o.children=[],$.each(i.children,(function(t,i){"block"==i.nodeName&&o.children.push({type:i.getAttribute("type"),id:i.getAttribute("uuid"),isPublished:!0,isImport:!0,preview:e.getContent(i),readable_name:e.blockMap[i.getAttribute("type")]})})),0==o.children.length&&(o.children=null)}})),0==n.children.length&&(n.children=null)}})),0==o.children.length&&(o.children=null)}}));var l=new XMLSerializer;e.importXML=l.serializeToString(o)}else e.fileError=!0})).then((function(){e.loading=!1,e.fileError||(e.showImportCourseware=!0),e.actionTitle="Import: "+e.importZIP.name+" ("+e.calcFileSize(e.importZIP.size)+")"}))},calcFileSize:function(e){return 0!=(e/1048576).toFixed(0)?(e/1048576).toFixed(1)+" MB":(e/1024).toFixed(1)+" kB"},importCompleteArchive:function(){this.storeLock=!0;var e=this,t=[],i={},s=this.importZIP,o=new Promise((function(e){var t=new FileReader;t.readAsDataURL(s),t.onloadend=function(){i.file=t.result,i.name=s.name,i.size=s.size,i.type=s.type,e(t.result)}}));t.push(o),Promise.all(t).then((function(){O.a.post("import_complete_archive",{cid:COURSEWARE.config.cid,fileData:i}).then((function(t){e.importData=!1,e.remoteData=!1,e.cleanLists(),e.courseware=JSON.parse(t.data.courseware),e.storeLock=!1})).catch((function(e){console.log(e)}))}))}}},Pe=Ie,Oe=Object(w["a"])(Pe,o,n,!1,null,null,null),Te=Oe.exports,Re=i("2f62");s["a"].use(Re["a"]);var Ue=new Re["a"].Store({state:{courseUsers:{},courseGroups:{}}}),Ve=Ue,Ge=i("a925");s["a"].use(Ge["a"]);var Fe={en_GB:{message:{tasksBackButton:"back to the selection",importFromCourse:"Import from Course",importFromCourseExplain:"Import content from another event where you are a lecturer",importFromArchiveButton:"Upload import archive",importFromArchiveExplain:"Upload a file that you have previously exported from a courseware",visibleFrom:"visible from",invisibleFrom:"invisible from",chapter:"Chapter",subchapter:"Subchapter",section:"Section",block:"Block",emptyChapter:"This Chapter is empty",emptyChapterInfo:"You can drop a subchapter here or add a new one",emptySubchapter:"This Subchapter is empty",emptySubchapterInfo:"You can drop a section here or add a new one",emptySection:"This Section is empty",emptySectionInfo:"You can add a Block in Courseware or drop one here",actions:"Actions",addSubelement:"Add subelement",editElement:"Edit element",deleteElement:"Delete element",setStudentsPermissions:"Set write permissions for students",setGroupsPermissions:"Set write permissions for groups",editDialogTitle:"Edit {0}",deleteDialogTitle:"Delete {0}",addDialogTitle:"Add Subelement",ButtonLabelSave:"save",ButtonLabelClose:"close",ButtonLabelYes:"yes",ButtonLabelNo:"no",title:"Title",deleteDialogQuestionBlock:"Do you really want to delete this item",deleteDialogQuestionElement:"Are you sure you want to delete this element and all its underlying elements",exportButton:"Download export archive",exportExplain:"Select content and download it as an archive file",exportingButton:"Export",importingButton:"Import complete archive",noRemoteCoursesAvailable:"There are no courses available for import",invalidArchiveFile:"The archive does not contain courseware data"}},de_DE:{message:{tasksBackButton:"zurück zur Auswahl",importFromCourse:"Aus Veranstaltung importieren",importFromCourseExplain:"Importieren Sie Inhalte aus einer anderen Veranstaltung in der Sie Dozent sind",importFromArchiveButton:"Import-Archiv hochladen",importFromArchiveExplain:"Laden Sie eine Datei hoch, die Sie zuvor aus einer Courseware exportiert haben",visibleFrom:"sichtbar ab",invisibleFrom:"unsichtbar ab",chapter:"Kapitel",subchapter:"Unterkapitel",section:"Abschnitt",block:"Block",emptyChapter:"Dieses Kapitel ist leer",emptyChapterInfo:"Sie können hier ein Unterkapitel ablegen oder ein neues hinzufügen",emptySubchapter:"Dieses Unterkapitel ist leer",emptySubchapterInfo:"Sie können hier einen Abschnitt ablegen oder einen neuen hinzufügen",emptySection:"Dieser Abschnitt ist leer",emptySectionInfo:"Sie können einen Block in Courseware hinzufügen oder hier einen ablegen",actions:"Aktionen",addSubelement:"Unterelement hinzufügen",editElement:"Element bearbeiten",deleteElement:"Element löschen",setStudentsPermissions:"Schreibrechte für Studierenden festlegen",setGroupsPermissions:"Schreibrechte für Gruppen festlegen",editDialogTitle:"{0} bearbeiten",deleteDialogTitle:"{0} löschen",addDialogTitle:"Unterelement hinzufügen",ButtonLabelSave:"Speichern",ButtonLabelClose:"Abbrechen",ButtonLabelYes:"Ja",ButtonLabelNo:"Nein",title:"Titel",deleteDialogQuestionBlock:"Möchten Sie dieses Element wirklich löschen",deleteDialogQuestionElement:"Möchten Sie dieses Element und alle darunter liegenden Elemente wirklich löschen",exportButton:"Export-Archiv herunterladen",exportExplain:"Wählen Sie Inhalte aus und laden diese als Archiv-Datei herunter",exportingButton:"Exportieren",importingButton:"Komplettes Archiv importieren",noRemoteCoursesAvailable:"Es sind keine Veranstaltungen für den Import verfügbar",invalidArchiveFile:"Das Archiv enthält keine Coursewaredaten"}}},Me=new Ge["a"]({locale:COURSEWARE.data.lang,messages:Fe}),je=Me;s["a"].config.productionTip=!1,new s["a"]({el:"#block_mananger_content",i18n:je,store:Ve,render:function(e){return e(Te)}})}});
//# sourceMappingURL=index.js.map